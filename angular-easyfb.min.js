/*! angular-easyfb
version: 0.1.0
build date: 2013-08-26
author: Robin Fan
https://github.com/pc035860/angular-easyfb.git */
angular.module("ezfb",[]).provider("$FB",function(){function a(b,c){0!==c.length&&(path=c.shift(),b[path]||(b[path]={}),a(b,c))}function b(a,b){return angular.isObject(b)?(angular.extend(a,b),void 0):angular.copy(a)}function c(a,b,c){return function(){a.apply(b,c)}}var d=["api","ui","getAuthResponse","getLoginStatus","login","logout","Event.subscribe","Event.unsubscribe","XFBML.parse","Canvas.Prefetcher.addStaticResource","Canvas.Prefetcher.setCollectionMode","Canvas.hideFlashElement","Canvas.scrollTo","Canvas.setAutoGrow","Canvas.setDoneLoading","Canvas.setSize","Canvas.setUrlHandler","Canvas.showFlashElement","Canvas.startTimer","Canvas.stopTimer"],e={status:!0,cookie:!0,xfbml:!0};return{setInitParams:function(a){b(e,a)},getInitParams:function(){return b(e)},$get:["$window","$q","$document","$parse","$rootScope",function(b,f,g,h,i){var j,k;if(!e.appId)throw new Error("appId required.");return g[0].getElementById("fb-root")||g.find("body").append('<div id="fb-root"></div>'),j=f.defer(),function(a){var b,c="facebook-jssdk",d=a.getElementsByTagName("script")[0];a.getElementById(c)||(b=a.createElement("script"),b.id=c,b.async=!0,b.src="//connect.facebook.net/en_US/all.js",d.parentNode.insertBefore(b,d))}(g[0]),b.fbAsyncInit=function(){b.FB.init(e),k.$$ready=!0,i.$apply(function(){j.resolve()})},k={$$ready:!1},angular.forEach(d,function(d){a(k,d.split(/\./));var e=h(d),f=e.assign;f(k,function(){var a=Array.prototype.slice.call(arguments),f=c(function(a){angular.forEach(a,function(b,c){if(angular.isFunction(b)){var d=b;a[c]=function(){var a=Array.prototype.slice.call(arguments);i.$$phase?d.apply(null,a):i.$apply(function(){d.apply(null,a)})}}});var c=e(b.FB);if(!c)throw new Error("Facebook API `FB."+d+"` doesn't exist.");c.apply(b.FB,a)},null,[a]);j.promise.then(f)})}),k}]}}).directive("ezfbXfbml",["$FB","$parse","$compile","$timeout",function(a,b,c,d){return{restrict:"EAC",compile:function(e){var f=e.html();return function(e,g,h){var i=!0,j=h.onrender||"",k=function(){i&&(e.$eval(j),i=!1)},l="xfbml.render";j&&(a.Event.subscribe(l,k),g.bind("$destroy",function(){a.Event.unsubscribe(l,k),g.unbind("$destroy")})),a.XFBML.parse(g[0]);var m=b(h.ezfbXfbml).assign;e.$watch(h.ezfbXfbml,function(b){b&&(i=!0,g.html(f),c(g.contents())(e),d(function(){a.XFBML.parse(g[0])}),(m||angular.noop)(e,!1))},!0)}}}}]);